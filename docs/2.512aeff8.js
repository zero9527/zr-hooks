(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{12:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),o=n(7),c=n(8);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}e.default=function(){var t=i(Object(r.useState)(),2),e=t[0],n=t[1],u=Object(o.b)({fetchFn:function(){return p()},expectResponse:function(t){return 0===t.code}}),s=u.isError,l=u.isLoading,f=u.resData,d=u.fetchData;Object(r.useEffect)((function(){Array.isArray(null==f?void 0:f.data)&&n(f.data)}),[f]);var p=function(){return new Promise((function(t,e){setTimeout((function(){t({code:0,data:["小明","小红","铁蛋","富贵"],msg:"ok"})}),300)}))};return a.a.createElement("div",null,a.a.createElement("h1",null,"useFetchData"),a.a.createElement("button",{onClick:function(){n([]),d()}},"fetchData"),a.a.createElement("div",null,a.a.createElement("p",null,s?"error":""),a.a.createElement("p",null,l?"fetching...":""),Array.isArray(e)&&e.map((function(t){return a.a.createElement("p",{key:t},t)}))),a.a.createElement(c.a,null,"\ntype ResType = {\n  code: number;\n  data: string[];\n  msg: string;\n};\n\nconst UseFetchDataExample: React.FC = () => {\n  const [dataList, setDataList] = useState<any[] | undefined>();\n  const { isError, isLoading, resData, fetchData } = useFetchData<ResType>({\n    fetchFn: () => getData(),\n    expectResponse: (res) => res.code === 0,\n  });\n\n  useEffect(() => {\n    if (Array.isArray(resData?.data)) {\n      setDataList(resData!.data);\n    }\n  }, [resData]);\n\n  const getData = () => {\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        resolve({\n          code: 0,\n          data: ['小明', '小红', '铁蛋', '富贵'],\n          msg: 'ok',\n        });\n      }, 300);\n    });\n  };\n\n  const onFetch = () => {\n    setDataList([]);\n    fetchData();\n  };\n\n  return (\n    <div>\n      <h1>useFetchData</h1>\n      <button onClick={onFetch}>fetchData</button>\n      <div>\n        <p>{isError ? 'error' : ''}</p>\n        <p>{isLoading ? 'fetching...' : ''}</p>\n        {Array.isArray(dataList) &&\n          dataList.map((item: any) => <p key={item}>{item}</p>)}\n      </div>\n      <PreCode>{codeStr}</PreCode>\n    </div>\n  );\n};\n\nexport default UseFetchDataExample;\n"))}},7:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return u}));var r=n(0);var a=t=>{const[e,n]=Object(r.useState)(t),a=Object(r.useRef)();return Object(r.useEffect)(()=>{a.current=e,n(t)},[t]),a.current};var o=(t,e=16,n=!0)=>{let a,o=n,c=0;return Object(r.useCallback)((function(...n){const r=(new Date).getTime();c=r-c>e&&0!==c?0:r,((...n)=>{o&&(o=!1,t.apply(null,n)),a&&clearTimeout(a),a=setTimeout(()=>{t.apply(null,n),o=!0},e)})(...n)}),[])};var c=t=>{const e=Object(r.useRef)(!1);Object(r.useEffect)(()=>()=>{window.removeEventListener("click",a,!1)},[]);const n=()=>{e.current=!1,window.removeEventListener("click",a,!1)},a=()=>{if("function"!=typeof t)return console.warn("callback 不是函数！");t&&e&&(t(),n())};return{addListener:()=>{e.current=!0,window.addEventListener("click",a,!1)},removeListener:n}},i=function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function c(t){try{u(r.next(t))}catch(t){o(t)}}function i(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,i)}u((r=r.apply(t,e||[])).next())}))};var u=function({fetchFn:t,expectResponse:e,isReady:n,deps:a=[]}){let o=!1;const[c,u]=Object(r.useState)(!1),[s,l]=Object(r.useState)(!1),[f,d]=Object(r.useState)();Object(r.useEffect)(()=>(void 0===n||n?p():l(!1),()=>{l(!1),o=!0}),a);const p=()=>i(this,void 0,void 0,(function*(){try{l(!0);const n=yield t();o||(l(!1),e(n)?d(n):u(!0))}catch(t){console.error(t),o||u(!0)}}));return{isError:c,isLoading:s,resData:f,fetchData:p}}},8:function(t,e,n){"use strict";var r=n(0),a=n.n(r),o=n(7);function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u={width:"100%",maxWidth:"600px",display:"inline-block",padding:"10px 20px",textAlign:"left",fontFamily:"Consolas",fontSize:"12px",overflowX:"auto"};e.a=function(t){var e=Object(r.useRef)(null),n=c(Object(r.useState)(!1),2),i=n[0],s=n[1];Object(r.useEffect)((function(){i&&hljs.highlightBlock(e.current)}),[i]),Object(r.useEffect)((function(){return function(){d()}}),[]),Object(r.useEffect)((function(){i?f():d()}),[i]);var l=Object(o.d)((function(){console.log("onWindowClick"),s(!1)})),f=l.addListener,d=l.removeListener;return a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){return s(!0)}},i?"隐藏代码":"显示代码"),i&&a.a.createElement("pre",{ref:e,onClick:function(t){return t.stopPropagation()}},a.a.createElement("p",null,"取消冒泡后，点这里不会收起"),a.a.createElement("code",{className:"js",style:u},t.children)))}}}]);